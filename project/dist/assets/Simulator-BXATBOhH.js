import{c as W,a as ut,b as dt,r as V,j as i,I as ft,X as pt,R as y,g as qe}from"./index-Cmd-lEEZ.js";import{G as E,C as Ie,P as ht,M as mt,S as gt}from"./ModelEditor-BhoIoHaI.js";import{c as I,f as A,_ as He,a as Je,b as yt,d as xt,i as F,T as _e,p as T,L as k,g as Xe,e as Ee,h as Qe,D as vt,G as bt,C as jt,j as X,k as U,S as At,A as Ot,l as wt,m as Me,n as Pt,o as q,q as St,r as kt,s as ae,t as Nt,u as le,w as $e,v as ue,x as _t,y as et,B as de,X as K,Y as B,z as Et,E as Tt,F as be,H as Y,I as $,J as ce,K as je}from"./LineChart-CpvEtXHj.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=W("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=W("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=W("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=W("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=W("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=W("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=W("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Ae=ut("https://nseasbkxgemrpwymkfwz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5zZWFzYmt4Z2VtcnB3eW1rZnd6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI2MzQ4ODQsImV4cCI6MjA1ODIxMDg4NH0.6hlmrN3w-m9v6WNjkRLYfDItTBsIS8LbNwwNSMET8Sw"),Oe={currentStep:0,isRunning:!1,results:[]},tt=dt((e,t)=>({selectedModel:null,simulationState:Oe,setSelectedModel:a=>{e({selectedModel:a,simulationState:Oe})},startSimulation:()=>{e(r=>({simulationState:{...r.simulationState,isRunning:!0}}));const a=setInterval(()=>{const{simulationState:r}=t();r.isRunning&&t().updateSimulationStep()},1e3);return()=>clearInterval(a)},pauseSimulation:()=>e(a=>({simulationState:{...a.simulationState,isRunning:!1}})),resetSimulation:()=>e({simulationState:Oe}),updateSimulationStep:()=>{const a=t(),{selectedModel:r,simulationState:n}=a;if(!r||!n.isRunning)return;const o=Lt(r,n.currentStep,a);e(s=>({simulationState:{...s.simulationState,currentStep:s.simulationState.currentStep+1,results:[...s.simulationState.results,o]}}))},saveSimulationResults:async()=>{const{selectedModel:a,simulationState:r}=t();if(!a||r.results.length===0)return;const{data:n}=await Ae.auth.getUser();if(!n.user)throw new Error("用户未登录");const{data:o,error:s}=await Ae.from("game_models").insert({name:a.name,type:a.type,description:a.description,config:{players:a.players,payoffMatrix:a.payoffMatrix},user_id:n.user.id}).select().single();if(s)throw console.error("保存模型失败:",s),s;const{error:f}=await Ae.from("simulation_results").insert({model_id:o.id,user_id:n.user.id,results:r.results});if(f)throw console.error("保存仿真结果失败:",f),f}}));function Lt(e,t,a){const r={step:t,playerChoices:{},payoffs:{},beliefs:{},signals:{}};switch(e.type){case E.COMPLETE_STATIC:e.players.forEach(d=>{const p=Dt(e,d.id,t,a);r.playerChoices[d.id]=d.strategies[p]});const n=e.players.map(d=>r.playerChoices[d.id]).join(","),o=e.payoffMatrix[n];e.players.forEach((d,p)=>{r.payoffs[d.id]=o[p]});break;case E.COMPLETE_DYNAMIC:if(t%2===0){const d=Kt(e,1,t,a);r.playerChoices[1]=e.players[0].strategies[d];const p=Bt(e,r.playerChoices[1]);r.playerChoices[2]=e.players[1].strategies[p],r.signals.path=`${r.playerChoices[1]} → ${r.playerChoices[2]}`}else{const d=a.simulationState.results;if(d.length>0){const p=d[d.length-1];r.playerChoices={...p.playerChoices},r.signals={...p.signals}}}const s=e.players.map(d=>r.playerChoices[d.id]).join(","),f=e.payoffMatrix[s];e.players.forEach((d,p)=>{r.payoffs[d.id]=f[p]});break;case E.INCOMPLETE_STATIC:if(t===0)e.players.forEach(d=>{r.beliefs[d.id]={},d.strategies.forEach(p=>{r.beliefs[d.id][p]=1/d.strategies.length})});else{const d=a.simulationState.results,p=d[d.length-1];r.beliefs=Ft(e,p)}e.players.forEach(d=>{const p=zt(e,d.id,r.beliefs,t);r.playerChoices[d.id]=d.strategies[p]});const l=e.players.map(d=>r.playerChoices[d.id]).join(","),c=e.payoffMatrix[l];e.players.forEach((d,p)=>{r.payoffs[d.id]=c[p]});break;case E.INCOMPLETE_DYNAMIC:if(t===0)r.signals.senderType=Math.random()<.5?"high":"low";else{const d=a.simulationState.results;r.signals.senderType=d[d.length-1].signals.senderType}const u=Vt(e,r.signals.senderType,t);r.playerChoices[1]=e.players[0].strategies[u];const m=Wt(e,r.playerChoices[1],t);r.playerChoices[2]=e.players[1].strategies[m];const g=e.players.map(d=>r.playerChoices[d.id]).join(","),h=e.payoffMatrix[g];e.players.forEach((d,p)=>{r.payoffs[d.id]=h[p]*(r.signals.senderType==="high"?1.2:.8)});break}return r}function Dt(e,t,a,r){const n=r.simulationState.results;if(a<5)return Math.floor(Math.random()*e.players[t-1].strategies.length);const o=new Map;e.players[t-1].strategies.forEach((g,h)=>{let d=0,p=0;n.forEach(x=>{x.playerChoices[t]===e.players[t-1].strategies[h]&&(d+=x.payoffs[t],p++)}),o.set(h,p>0?d/p:0)});const s=.5,f=Array.from(o.values()).map(g=>Math.exp(g/s)),l=f.reduce((g,h)=>g+h,0),c=f.map(g=>g/l),u=Math.random();let m=0;for(let g=0;g<c.length;g++)if(m+=c[g],u<=m)return g;return 0}function Kt(e,t,a,r){var f;const n=r.simulationState.results;if(a<5)return Math.floor(Math.random()*e.players[t-1].strategies.length);const o=new Map;for(let l=1;l<n.length;l++){const c=n[l-1].playerChoices[t],u=n[l].playerChoices[3-t];o.has(c)||o.set(c,[]),(f=o.get(c))==null||f.push(e.players[1].strategies.indexOf(u))}const s=e.players[0].strategies.map((l,c)=>{const u=o.get(l)||[];if(u.length===0)return 0;const m=u.reduce((d,p)=>d+p,0)/u.length,g=e.players[1].strategies[Math.round(m)];return e.payoffMatrix[`${l},${g}`][t-1]});return s.indexOf(Math.max(...s))}function Bt(e,t){const a=e.players[1].strategies.map((r,n)=>{const o=`${t},${r}`;return e.payoffMatrix[o][1]});return a.indexOf(Math.max(...a))}function Ft(e,t){const a={};return e.players.forEach(r=>{a[r.id]={};const n=t.beliefs[r.id],o=t.payoffs[r.id];let s=0;r.strategies.forEach(f=>{const l=n[f]*Math.exp(o/10);a[r.id][f]=l,s+=l}),Object.keys(a[r.id]).forEach(f=>{a[r.id][f]/=s})}),a}function zt(e,t,a,r){if(r<5)return Math.floor(Math.random()*e.players[t-1].strategies.length);const n=e.players[t-1].strategies.map((o,s)=>{let f=0;return e.players[2-t].strategies.forEach(l=>{const c=a[3-t][l],u=t===1?`${o},${l}`:`${l},${o}`,m=e.payoffMatrix[u][t-1];f+=c*m}),f});return n.indexOf(Math.max(...n))}function Vt(e,t,a){if(a<5)return Math.floor(Math.random()*e.players[0].strategies.length);const r=t==="high"?.8:.2,n=e.players[0].strategies,o=n.map((l,c)=>{const u=c/(n.length-1);return Math.abs(u-r)}),s=Math.random();let f=0;for(let l=0;l<o.length;l++)if(f+=o[l],s<=f)return l;return 0}function Wt(e,t,a){if(a<5)return Math.floor(Math.random()*e.players[1].strategies.length);const n=e.players[0].strategies.indexOf(t)/(e.players[0].strategies.length-1),o=e.players[1].strategies,s=o.map((c,u)=>{const m=u/(o.length-1);return Math.abs(m-n)}),f=Math.random();let l=0;for(let c=0;c<s.length;c++)if(l+=s[c],f<=l)return c;return 0}const Gt=()=>{const[e,t]=V.useState(null),[a,r]=V.useState(null),[n,o]=V.useState(null),[s,f]=V.useState(!1),{setSelectedModel:l}=tt(),c=e?Ie.filter(h=>h.type===e):Ie,u=()=>{f(!0)},m=h=>{o({...h,id:crypto.randomUUID(),isClassic:!1})},g=h=>{l(h),o(null),f(!1)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[i.jsx(Ct,{className:"w-6 h-6 text-blue-600"}),i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"博弈模型选择"})]}),i.jsx("div",{className:"mb-6",children:i.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[i.jsx("button",{onClick:()=>t(null),className:`px-4 py-2 rounded-full whitespace-nowrap ${e===null?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"全部"}),Object.values(E).map(h=>i.jsx("button",{onClick:()=>t(h),className:`px-4 py-2 rounded-full whitespace-nowrap ${e===h?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:h},h))]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c.map(h=>i.jsxs("div",{className:"border rounded-lg p-4 hover:border-blue-500 transition-colors",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:h.name}),i.jsx("p",{className:"text-sm text-gray-500 mb-2",children:h.type}),i.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:h.description}),i.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>r(h),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[i.jsx(ft,{className:"w-4 h-4"}),"查看详情"]}),i.jsxs("button",{onClick:()=>m(h),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:[i.jsx(De,{className:"w-4 h-4"}),"参数设置"]})]}),i.jsx("button",{onClick:()=>l(h),className:"px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:"选择模型"})]})]},h.id)),i.jsxs("button",{onClick:u,className:"border-2 border-dashed border-gray-300 rounded-lg p-4 hover:border-blue-500 hover:bg-blue-50 transition-colors flex flex-col items-center justify-center gap-2 text-gray-600 hover:text-blue-600",children:[i.jsx(ht,{className:"w-8 h-8"}),i.jsx("span",{children:"创建自定义模型"}),i.jsxs("p",{className:"text-xs text-center text-gray-500",children:["设计您自己的博弈模型，",i.jsx("br",{}),"定制参与者、策略和收益"]})]})]})]}),a&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:a.name}),i.jsx("button",{onClick:()=>r(null),className:"text-gray-500 hover:text-gray-700",children:i.jsx(pt,{className:"w-6 h-6"})})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"博弈类型"}),i.jsx("p",{className:"text-gray-600",children:a.type})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"模型描述"}),i.jsx("p",{className:"text-gray-600",children:a.description})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"参与者"}),i.jsx("div",{className:"grid grid-cols-2 gap-4",children:a.players.map(h=>i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsx("h5",{className:"font-semibold mb-2",children:h.name}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"可选策略："}),i.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:h.strategies.map(d=>i.jsx("li",{children:d},d))})]})]},h.id))})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"收益矩阵"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border-collapse border border-gray-200",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"border border-gray-200 px-4 py-2 bg-gray-50",children:"策略组合"}),a.players.map(h=>i.jsxs("th",{className:"border border-gray-200 px-4 py-2 bg-gray-50",children:[h.name,"收益"]},h.id))]})}),i.jsx("tbody",{children:Object.entries(a.payoffMatrix).map(([h,d])=>i.jsxs("tr",{children:[i.jsx("td",{className:"border border-gray-200 px-4 py-2",children:h}),d.map((p,x)=>i.jsx("td",{className:"border border-gray-200 px-4 py-2 text-center",children:p},x))]},h))})]})})]})]}),i.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[i.jsx("button",{onClick:()=>r(null),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"关闭"}),i.jsxs("button",{onClick:()=>{m(a),r(null)},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[i.jsx(De,{className:"w-4 h-4"}),"参数设置"]})]})]})})}),(n||s)&&i.jsx(mt,{model:n,onSave:g,onCancel:()=>{o(null),f(!1)},isCustom:s})]})};var Zt=["points","className","baseLinePoints","connectNulls"];function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},H.apply(this,arguments)}function Yt(e,t){if(e==null)return{};var a=Ut(e,t),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ut(e,t){if(e==null)return{};var a={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;a[r]=e[r]}return a}function Ke(e){return Xt(e)||Jt(e)||Ht(e)||qt()}function qt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ht(e,t){if(e){if(typeof e=="string")return Pe(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Pe(e,t)}}function Jt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xt(e){if(Array.isArray(e))return Pe(e)}function Pe(e,t){(t==null||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var Be=function(t){return t&&t.x===+t.x&&t.y===+t.y},Qt=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=[[]];return t.forEach(function(r){Be(r)?a[a.length-1].push(r):a[a.length-1].length>0&&a.push([])}),Be(t[0])&&a[a.length-1].push(t[0]),a[a.length-1].length<=0&&(a=a.slice(0,-1)),a},ne=function(t,a){var r=Qt(t);a&&(r=[r.reduce(function(o,s){return[].concat(Ke(o),Ke(s))},[])]);var n=r.map(function(o){return o.reduce(function(s,f,l){return"".concat(s).concat(l===0?"M":"L").concat(f.x,",").concat(f.y)},"")}).join("");return r.length===1?"".concat(n,"Z"):n},er=function(t,a,r){var n=ne(t,r);return"".concat(n.slice(-1)==="Z"?n.slice(0,-1):n,"L").concat(ne(a.reverse(),r).slice(1))},tr=function(t){var a=t.points,r=t.className,n=t.baseLinePoints,o=t.connectNulls,s=Yt(t,Zt);if(!a||!a.length)return null;var f=I("recharts-polygon",r);if(n&&n.length){var l=s.stroke&&s.stroke!=="none",c=er(a,n,o);return y.createElement("g",{className:f},y.createElement("path",H({},A(s,!0),{fill:c.slice(-1)==="Z"?s.fill:"none",stroke:"none",d:c})),l?y.createElement("path",H({},A(s,!0),{fill:"none",d:ne(a,o)})):null,l?y.createElement("path",H({},A(s,!0),{fill:"none",d:ne(n,o)})):null)}var u=ne(a,o);return y.createElement("path",H({},A(s,!0),{fill:u.slice(-1)==="Z"?s.fill:"none",className:f,d:u}))},rr=He,ar=yt,nr=Je;function ir(e,t){return e&&e.length?rr(e,nr(t),ar):void 0}var sr=ir;const or=qe(sr);var lr=He,cr=Je,ur=xt;function dr(e,t){return e&&e.length?lr(e,cr(t),ur):void 0}var fr=dr;const pr=qe(fr);var hr=["cx","cy","angle","ticks","axisLine"],mr=["ticks","tick","angle","tickFormatter","stroke"];function Q(e){"@babel/helpers - typeof";return Q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(e)}function ie(){return ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},ie.apply(this,arguments)}function Fe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),a.push.apply(a,r)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Fe(Object(a),!0).forEach(function(r){ge(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fe(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function ze(e,t){if(e==null)return{};var a=gr(e,t),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function gr(e,t){if(e==null)return{};var a={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;a[r]=e[r]}return a}function yr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ve(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,at(r.key),r)}}function xr(e,t,a){return t&&Ve(e.prototype,t),a&&Ve(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function vr(e,t,a){return t=pe(t),br(e,rt()?Reflect.construct(t,a||[],pe(e).constructor):t.apply(e,a))}function br(e,t){if(t&&(Q(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jr(e)}function jr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rt=function(){return!!e})()}function pe(e){return pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},pe(e)}function Ar(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Se(e,t)}function Se(e,t){return Se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Se(e,t)}function ge(e,t,a){return t=at(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function at(e){var t=Or(e,"string");return Q(t)=="symbol"?t:t+""}function Or(e,t){if(Q(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t||"default");if(Q(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ye=function(e){function t(){return yr(this,t),vr(this,t,arguments)}return Ar(t,e),xr(t,[{key:"getTickValueCoord",value:function(r){var n=r.coordinate,o=this.props,s=o.angle,f=o.cx,l=o.cy;return T(f,l,n,s)}},{key:"getTickTextAnchor",value:function(){var r=this.props.orientation,n;switch(r){case"left":n="end";break;case"right":n="start";break;default:n="middle";break}return n}},{key:"getViewBox",value:function(){var r=this.props,n=r.cx,o=r.cy,s=r.angle,f=r.ticks,l=or(f,function(u){return u.coordinate||0}),c=pr(f,function(u){return u.coordinate||0});return{cx:n,cy:o,startAngle:s,endAngle:s,innerRadius:c.coordinate||0,outerRadius:l.coordinate||0}}},{key:"renderAxisLine",value:function(){var r=this.props,n=r.cx,o=r.cy,s=r.angle,f=r.ticks,l=r.axisLine,c=ze(r,hr),u=f.reduce(function(d,p){return[Math.min(d[0],p.coordinate),Math.max(d[1],p.coordinate)]},[1/0,-1/0]),m=T(n,o,u[0],s),g=T(n,o,u[1],s),h=L(L(L({},A(c,!1)),{},{fill:"none"},A(l,!1)),{},{x1:m.x,y1:m.y,x2:g.x,y2:g.y});return y.createElement("line",ie({className:"recharts-polar-radius-axis-line"},h))}},{key:"renderTicks",value:function(){var r=this,n=this.props,o=n.ticks,s=n.tick,f=n.angle,l=n.tickFormatter,c=n.stroke,u=ze(n,mr),m=this.getTickTextAnchor(),g=A(u,!1),h=A(s,!1),d=o.map(function(p,x){var b=r.getTickValueCoord(p),j=L(L(L(L({textAnchor:m,transform:"rotate(".concat(90-f,", ").concat(b.x,", ").concat(b.y,")")},g),{},{stroke:"none",fill:c},h),{},{index:x},b),{},{payload:p});return y.createElement(k,ie({className:I("recharts-polar-radius-axis-tick",Xe(s)),key:"tick-".concat(p.coordinate)},Ee(r.props,p,x)),t.renderTickItem(s,j,l?l(p.value,x):p.value))});return y.createElement(k,{className:"recharts-polar-radius-axis-ticks"},d)}},{key:"render",value:function(){var r=this.props,n=r.ticks,o=r.axisLine,s=r.tick;return!n||!n.length?null:y.createElement(k,{className:I("recharts-polar-radius-axis",this.props.className)},o&&this.renderAxisLine(),s&&this.renderTicks(),Qe.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(r,n,o){var s;return y.isValidElement(r)?s=y.cloneElement(r,n):F(r)?s=r(n):s=y.createElement(_e,ie({},n,{className:"recharts-polar-radius-axis-tick-value"}),o),s}}])}(V.PureComponent);ge(ye,"displayName","PolarRadiusAxis");ge(ye,"axisType","radiusAxis");ge(ye,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function ee(e){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(e)}function z(){return z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},z.apply(this,arguments)}function We(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),a.push.apply(a,r)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?We(Object(a),!0).forEach(function(r){xe(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):We(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function wr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ge(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,it(r.key),r)}}function Pr(e,t,a){return t&&Ge(e.prototype,t),a&&Ge(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sr(e,t,a){return t=he(t),kr(e,nt()?Reflect.construct(t,a||[],he(e).constructor):t.apply(e,a))}function kr(e,t){if(t&&(ee(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nr(e)}function Nr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nt=function(){return!!e})()}function he(e){return he=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},he(e)}function _r(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ke(e,t)}function ke(e,t){return ke=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},ke(e,t)}function xe(e,t,a){return t=it(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function it(e){var t=Er(e,"string");return ee(t)=="symbol"?t:t+""}function Er(e,t){if(ee(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t||"default");if(ee(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tr=Math.PI/180,Ze=1e-5,ve=function(e){function t(){return wr(this,t),Sr(this,t,arguments)}return _r(t,e),Pr(t,[{key:"getTickLineCoord",value:function(r){var n=this.props,o=n.cx,s=n.cy,f=n.radius,l=n.orientation,c=n.tickSize,u=c||8,m=T(o,s,f,r.coordinate),g=T(o,s,f+(l==="inner"?-1:1)*u,r.coordinate);return{x1:m.x,y1:m.y,x2:g.x,y2:g.y}}},{key:"getTickTextAnchor",value:function(r){var n=this.props.orientation,o=Math.cos(-r.coordinate*Tr),s;return o>Ze?s=n==="outer"?"start":"end":o<-Ze?s=n==="outer"?"end":"start":s="middle",s}},{key:"renderAxisLine",value:function(){var r=this.props,n=r.cx,o=r.cy,s=r.radius,f=r.axisLine,l=r.axisLineType,c=D(D({},A(this.props,!1)),{},{fill:"none"},A(f,!1));if(l==="circle")return y.createElement(vt,z({className:"recharts-polar-angle-axis-line"},c,{cx:n,cy:o,r:s}));var u=this.props.ticks,m=u.map(function(g){return T(n,o,s,g.coordinate)});return y.createElement(tr,z({className:"recharts-polar-angle-axis-line"},c,{points:m}))}},{key:"renderTicks",value:function(){var r=this,n=this.props,o=n.ticks,s=n.tick,f=n.tickLine,l=n.tickFormatter,c=n.stroke,u=A(this.props,!1),m=A(s,!1),g=D(D({},u),{},{fill:"none"},A(f,!1)),h=o.map(function(d,p){var x=r.getTickLineCoord(d),b=r.getTickTextAnchor(d),j=D(D(D({textAnchor:b},u),{},{stroke:"none",fill:c},m),{},{index:p,payload:d,x:x.x2,y:x.y2});return y.createElement(k,z({className:I("recharts-polar-angle-axis-tick",Xe(s)),key:"tick-".concat(d.coordinate)},Ee(r.props,d,p)),f&&y.createElement("line",z({className:"recharts-polar-angle-axis-tick-line"},g,x)),s&&t.renderTickItem(s,j,l?l(d.value,p):d.value))});return y.createElement(k,{className:"recharts-polar-angle-axis-ticks"},h)}},{key:"render",value:function(){var r=this.props,n=r.ticks,o=r.radius,s=r.axisLine;return o<=0||!n||!n.length?null:y.createElement(k,{className:I("recharts-polar-angle-axis",this.props.className)},s&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(r,n,o){var s;return y.isValidElement(r)?s=y.cloneElement(r,n):F(r)?s=r(n):s=y.createElement(_e,z({},n,{className:"recharts-polar-angle-axis-tick-value"}),o),s}}])}(V.PureComponent);xe(ve,"displayName","PolarAngleAxis");xe(ve,"axisType","angleAxis");xe(ve,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var fe;function te(e){"@babel/helpers - typeof";return te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(e)}function J(){return J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},J.apply(this,arguments)}function Ye(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),a.push.apply(a,r)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Ye(Object(a),!0).forEach(function(r){w(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ye(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function Cr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ue(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ot(r.key),r)}}function Rr(e,t,a){return t&&Ue(e.prototype,t),a&&Ue(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ir(e,t,a){return t=me(t),Mr(e,st()?Reflect.construct(t,a||[],me(e).constructor):t.apply(e,a))}function Mr(e,t){if(t&&(te(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $r(e)}function $r(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function st(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(st=function(){return!!e})()}function me(e){return me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},me(e)}function Lr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ne(e,t)}function Ne(e,t){return Ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Ne(e,t)}function w(e,t,a){return t=ot(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ot(e){var t=Dr(e,"string");return te(t)=="symbol"?t:t+""}function Dr(e,t){if(te(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t||"default");if(te(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var C=function(e){function t(a){var r;return Cr(this,t),r=Ir(this,t,[a]),w(r,"pieRef",null),w(r,"sectorRefs",[]),w(r,"id",_t("recharts-pie-")),w(r,"handleAnimationEnd",function(){var n=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),F(n)&&n()}),w(r,"handleAnimationStart",function(){var n=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),F(n)&&n()}),r.state={isAnimationFinished:!a.isAnimationActive,prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,sectorToFocus:0},r}return Lr(t,e),Rr(t,[{key:"isActiveIndex",value:function(r){var n=this.props.activeIndex;return Array.isArray(n)?n.indexOf(r)!==-1:r===n}},{key:"hasActiveIndex",value:function(){var r=this.props.activeIndex;return Array.isArray(r)?r.length!==0:r||r===0}},{key:"renderLabels",value:function(r){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var o=this.props,s=o.label,f=o.labelLine,l=o.dataKey,c=o.valueKey,u=A(this.props,!1),m=A(s,!1),g=A(f,!1),h=s&&s.offsetRadius||20,d=r.map(function(p,x){var b=(p.startAngle+p.endAngle)/2,j=T(p.cx,p.cy,p.outerRadius+h,b),P=v(v(v(v({},u),p),{},{stroke:"none"},m),{},{index:x,textAnchor:t.getTextAnchor(j.x,p.cx)},j),G=v(v(v(v({},u),p),{},{fill:"none",stroke:p.fill},g),{},{index:x,points:[T(p.cx,p.cy,p.outerRadius,b),j]}),N=l;return X(l)&&X(c)?N="value":X(l)&&(N=c),y.createElement(k,{key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(x)},f&&t.renderLabelLineItem(f,G,"line"),t.renderLabelItem(s,P,U(p,N)))});return y.createElement(k,{className:"recharts-pie-labels"},d)}},{key:"renderSectorsStatically",value:function(r){var n=this,o=this.props,s=o.activeShape,f=o.blendStroke,l=o.inactiveShape;return r.map(function(c,u){if((c==null?void 0:c.startAngle)===0&&(c==null?void 0:c.endAngle)===0&&r.length!==1)return null;var m=n.isActiveIndex(u),g=l&&n.hasActiveIndex()?l:null,h=m?s:g,d=v(v({},c),{},{stroke:f?c.fill:c.stroke,tabIndex:-1});return y.createElement(k,J({ref:function(x){x&&!n.sectorRefs.includes(x)&&n.sectorRefs.push(x)},tabIndex:-1,className:"recharts-pie-sector"},Ee(n.props,c,u),{key:"sector-".concat(c==null?void 0:c.startAngle,"-").concat(c==null?void 0:c.endAngle,"-").concat(c.midAngle,"-").concat(u)}),y.createElement(At,J({option:h,isActive:m,shapeType:"sector"},d)))})}},{key:"renderSectorsWithAnimation",value:function(){var r=this,n=this.props,o=n.sectors,s=n.isAnimationActive,f=n.animationBegin,l=n.animationDuration,c=n.animationEasing,u=n.animationId,m=this.state,g=m.prevSectors,h=m.prevIsAnimationActive;return y.createElement(Ot,{begin:f,duration:l,isActive:s,easing:c,from:{t:0},to:{t:1},key:"pie-".concat(u,"-").concat(h),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(d){var p=d.t,x=[],b=o&&o[0],j=b.startAngle;return o.forEach(function(P,G){var N=g&&g[G],M=G>0?wt(P,"paddingAngle",0):0;if(N){var re=Me(N.endAngle-N.startAngle,P.endAngle-P.startAngle),O=v(v({},P),{},{startAngle:j+M,endAngle:j+re(p)+M});x.push(O),j=O.endAngle}else{var Z=P.endAngle,_=P.startAngle,se=Me(0,Z-_),oe=se(p),R=v(v({},P),{},{startAngle:j+M,endAngle:j+oe+M});x.push(R),j=R.endAngle}}),y.createElement(k,null,r.renderSectorsStatically(x))})}},{key:"attachKeyboardHandlers",value:function(r){var n=this;r.onkeydown=function(o){if(!o.altKey)switch(o.key){case"ArrowLeft":{var s=++n.state.sectorToFocus%n.sectorRefs.length;n.sectorRefs[s].focus(),n.setState({sectorToFocus:s});break}case"ArrowRight":{var f=--n.state.sectorToFocus<0?n.sectorRefs.length-1:n.state.sectorToFocus%n.sectorRefs.length;n.sectorRefs[f].focus(),n.setState({sectorToFocus:f});break}case"Escape":{n.sectorRefs[n.state.sectorToFocus].blur(),n.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var r=this.props,n=r.sectors,o=r.isAnimationActive,s=this.state.prevSectors;return o&&n&&n.length&&(!s||!Pt(s,n))?this.renderSectorsWithAnimation():this.renderSectorsStatically(n)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var r=this,n=this.props,o=n.hide,s=n.sectors,f=n.className,l=n.label,c=n.cx,u=n.cy,m=n.innerRadius,g=n.outerRadius,h=n.isAnimationActive,d=this.state.isAnimationFinished;if(o||!s||!s.length||!q(c)||!q(u)||!q(m)||!q(g))return null;var p=I("recharts-pie",f);return y.createElement(k,{tabIndex:this.props.rootTabIndex,className:p,ref:function(b){r.pieRef=b}},this.renderSectors(),l&&this.renderLabels(s),Qe.renderCallByParent(this.props,null,!1),(!h||d)&&St.renderCallByParent(this.props,s,!1))}}],[{key:"getDerivedStateFromProps",value:function(r,n){return n.prevIsAnimationActive!==r.isAnimationActive?{prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:[],isAnimationFinished:!0}:r.isAnimationActive&&r.animationId!==n.prevAnimationId?{prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:n.curSectors,isAnimationFinished:!0}:r.sectors!==n.curSectors?{curSectors:r.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(r,n){return r>n?"start":r<n?"end":"middle"}},{key:"renderLabelLineItem",value:function(r,n,o){if(y.isValidElement(r))return y.cloneElement(r,n);if(F(r))return r(n);var s=I("recharts-pie-label-line",typeof r!="boolean"?r.className:"");return y.createElement(jt,J({},n,{key:o,type:"linear",className:s}))}},{key:"renderLabelItem",value:function(r,n,o){if(y.isValidElement(r))return y.cloneElement(r,n);var s=o;if(F(r)&&(s=r(n),y.isValidElement(s)))return s;var f=I("recharts-pie-label-text",typeof r!="boolean"&&!F(r)?r.className:"");return y.createElement(_e,J({},n,{alignmentBaseline:"middle",className:f}),s)}}])}(V.PureComponent);fe=C;w(C,"displayName","Pie");w(C,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!bt.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});w(C,"parseDeltaAngle",function(e,t){var a=ue(t-e),r=Math.min(Math.abs(t-e),360);return a*r});w(C,"getRealPieData",function(e){var t=e.data,a=e.children,r=A(e,!1),n=kt(a,ae);return t&&t.length?t.map(function(o,s){return v(v(v({payload:o},r),o),n&&n[s]&&n[s].props)}):n&&n.length?n.map(function(o){return v(v({},r),o.props)}):[]});w(C,"parseCoordinateOfPie",function(e,t){var a=t.top,r=t.left,n=t.width,o=t.height,s=Nt(n,o),f=r+le(e.cx,n,n/2),l=a+le(e.cy,o,o/2),c=le(e.innerRadius,s,0),u=le(e.outerRadius,s,s*.8),m=e.maxRadius||Math.sqrt(n*n+o*o)/2;return{cx:f,cy:l,innerRadius:c,outerRadius:u,maxRadius:m}});w(C,"getComposedData",function(e){var t=e.item,a=e.offset,r=t.type.defaultProps!==void 0?v(v({},t.type.defaultProps),t.props):t.props,n=fe.getRealPieData(r);if(!n||!n.length)return null;var o=r.cornerRadius,s=r.startAngle,f=r.endAngle,l=r.paddingAngle,c=r.dataKey,u=r.nameKey,m=r.valueKey,g=r.tooltipType,h=Math.abs(r.minAngle),d=fe.parseCoordinateOfPie(r,a),p=fe.parseDeltaAngle(s,f),x=Math.abs(p),b=c;X(c)&&X(m)?($e(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),b="value"):X(c)&&($e(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),b=m);var j=n.filter(function(O){return U(O,b,0)!==0}).length,P=(x>=360?j:j-1)*l,G=x-j*h-P,N=n.reduce(function(O,Z){var _=U(Z,b,0);return O+(q(_)?_:0)},0),M;if(N>0){var re;M=n.map(function(O,Z){var _=U(O,b,0),se=U(O,u,Z),oe=(q(_)?_:0)/N,R;Z?R=re.endAngle+ue(p)*l*(_!==0?1:0):R=s;var Te=R+ue(p)*((_!==0?h:0)+oe*G),Ce=(R+Te)/2,Re=(d.innerRadius+d.outerRadius)/2,lt=[{name:se,value:_,payload:O,dataKey:b,type:g}],ct=T(d.cx,d.cy,Re,Ce);return re=v(v(v({percent:oe,cornerRadius:o,name:se,tooltipPayload:lt,midAngle:Ce,middleRadius:Re,tooltipPosition:ct},O),d),{},{value:U(O,b),startAngle:R,endAngle:Te,payload:O,paddingAngle:ue(p)*l}),re})}return v(v({},d),{},{sectors:M,data:n})});var we=et({chartName:"BarChart",GraphicalChild:de,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:K},{axisType:"yAxis",AxisComp:B}],formatAxisMap:Et}),Kr=et({chartName:"PieChart",GraphicalChild:C,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:ve},{axisType:"radiusAxis",AxisComp:ye}],formatAxisMap:Tt,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const S=["#8884d8","#82ca9d","#ffc658","#ff8042"],Br=()=>{const{selectedModel:e,simulationState:t,startSimulation:a,pauseSimulation:r,resetSimulation:n,saveSimulationResults:o}=tt();if(!e)return i.jsx("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:i.jsx("p",{className:"text-gray-500 text-center",children:"请先选择一个博弈模型"})});const s=async()=>{try{await o(),alert("仿真结果保存成功！")}catch{alert("保存失败，请重试")}},f=()=>{if(t.results.length===0)return i.jsx("p",{className:"text-gray-500 text-center",children:"暂无仿真数据"});switch(e.type){case E.COMPLETE_STATIC:return i.jsxs("div",{className:"space-y-6",children:[i.jsxs(be,{width:800,height:300,data:t.results,margin:{top:5,right:30,left:20,bottom:5},children:[i.jsx(Y,{strokeDasharray:"3 3"}),i.jsx(K,{dataKey:"step"}),i.jsx(B,{}),i.jsx($,{}),i.jsx(ce,{}),e.players.map((l,c)=>i.jsx(je,{type:"monotone",dataKey:u=>u.payoffs[l.id],name:`${l.name}收益`,stroke:S[c]},l.id))]}),i.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.players.map((l,c)=>i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("h4",{className:"text-lg font-semibold mb-2",children:[l.name,"策略分布"]}),i.jsxs(Kr,{width:300,height:200,children:[i.jsx(C,{data:l.strategies.map(u=>({name:u,value:t.results.filter(m=>m.playerChoices[l.id]===u).length})),cx:150,cy:100,innerRadius:40,outerRadius:80,fill:"#8884d8",dataKey:"value",label:!0,children:l.strategies.map((u,m)=>i.jsx(ae,{fill:S[m%S.length]},`cell-${m}`))}),i.jsx($,{}),i.jsx(ce,{})]})]},l.id))})]});case E.COMPLETE_DYNAMIC:return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-semibold mb-2",children:"累计收益"}),i.jsxs(we,{width:400,height:300,data:e.players.map(l=>({name:l.name,value:t.results.reduce((c,u)=>c+u.payoffs[l.id],0)})),margin:{top:5,right:30,left:20,bottom:5},children:[i.jsx(Y,{strokeDasharray:"3 3"}),i.jsx(K,{dataKey:"name"}),i.jsx(B,{}),i.jsx($,{}),i.jsx(de,{dataKey:"value",fill:"#8884d8",children:e.players.map((l,c)=>i.jsx(ae,{fill:S[c%S.length]},`cell-${c}`))})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-semibold mb-2",children:"决策树路径"}),i.jsx("div",{className:"border rounded-lg p-4 h-[300px] overflow-auto",children:t.results.map((l,c)=>i.jsxs("div",{className:"mb-2 flex items-center",children:[i.jsxs("span",{className:"text-sm text-gray-500",children:["步骤 ",l.step,":"]}),i.jsx("div",{className:"ml-2 flex items-center",children:e.players.map((u,m)=>i.jsxs(y.Fragment,{children:[i.jsxs("span",{className:"px-2 py-1 rounded bg-gray-100 text-sm",children:[u.name,": ",l.playerChoices[u.id]]}),m<e.players.length-1&&i.jsx(Le,{className:"w-4 h-4 mx-1 text-gray-400"})]},u.id))})]},c))})]})]}),i.jsxs(be,{width:800,height:200,data:t.results,margin:{top:5,right:30,left:20,bottom:5},children:[i.jsx(Y,{strokeDasharray:"3 3"}),i.jsx(K,{dataKey:"step"}),i.jsx(B,{}),i.jsx($,{}),i.jsx(ce,{}),e.players.map((l,c)=>i.jsx(je,{type:"monotone",dataKey:u=>u.payoffs[l.id],name:`${l.name}收益`,stroke:S[c]},l.id))]})]});case E.INCOMPLETE_STATIC:return i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-semibold mb-2",children:"策略选择频率"}),i.jsxs(we,{width:400,height:300,data:e.players.flatMap(l=>l.strategies.map(c=>({name:`${l.name}-${c}`,count:t.results.filter(u=>u.playerChoices[l.id]===c).length}))),margin:{top:5,right:30,left:20,bottom:5},children:[i.jsx(Y,{strokeDasharray:"3 3"}),i.jsx(K,{dataKey:"name"}),i.jsx(B,{}),i.jsx($,{}),i.jsx(de,{dataKey:"count",fill:"#8884d8",children:e.players.flatMap(l=>l.strategies.map((c,u)=>i.jsx(ae,{fill:S[u%S.length]},`cell-${u}`)))})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-semibold mb-2",children:"平均收益"}),i.jsxs(we,{width:400,height:300,data:e.players.map(l=>({name:l.name,value:t.results.reduce((c,u)=>c+u.payoffs[l.id],0)/t.results.length})),margin:{top:5,right:30,left:20,bottom:5},children:[i.jsx(Y,{strokeDasharray:"3 3"}),i.jsx(K,{dataKey:"name"}),i.jsx(B,{}),i.jsx($,{}),i.jsx(de,{dataKey:"value",fill:"#8884d8",children:e.players.map((l,c)=>i.jsx(ae,{fill:S[c%S.length]},`cell-${c}`))})]})]})]})});case E.INCOMPLETE_DYNAMIC:return i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-semibold mb-2",children:"信号传递效果"}),i.jsxs(be,{width:400,height:300,data:t.results,margin:{top:5,right:30,left:20,bottom:5},children:[i.jsx(Y,{strokeDasharray:"3 3"}),i.jsx(K,{dataKey:"step"}),i.jsx(B,{}),i.jsx($,{}),i.jsx(ce,{}),e.players.map((l,c)=>i.jsx(je,{type:"monotone",dataKey:u=>u.payoffs[l.id],name:`${l.name}收益`,stroke:S[c]},l.id))]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-semibold mb-2",children:"策略匹配分析"}),i.jsx("div",{className:"border rounded-lg p-4 h-[300px] overflow-auto",children:t.results.map((l,c)=>i.jsxs("div",{className:"mb-2",children:[i.jsxs("div",{className:"text-sm text-gray-500",children:["回合 ",l.step+1]}),i.jsx("div",{className:"grid grid-cols-2 gap-2 mt-1",children:e.players.map(u=>i.jsxs("div",{className:"px-2 py-1 rounded bg-gray-100 text-sm",children:[i.jsxs("span",{className:"font-medium",children:[u.name,":"]})," ",l.playerChoices[u.id],i.jsxs("span",{className:"ml-2 text-gray-600",children:["(收益: ",l.payoffs[u.id],")"]})]},u.id))})]},c))})]})]})});default:return i.jsx("p",{className:"text-gray-500 text-center",children:"暂不支持该类型博弈的可视化"})}};return i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"space-x-2",children:[t.isRunning?i.jsxs("button",{onClick:r,className:"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors flex items-center gap-2",children:[i.jsx(Rt,{className:"w-4 h-4"}),"暂停"]}):i.jsxs("button",{onClick:a,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center gap-2",children:[i.jsx(It,{className:"w-4 h-4"}),"开始仿真"]}),i.jsxs("button",{onClick:n,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors flex items-center gap-2",children:[i.jsx(Mt,{className:"w-4 h-4"}),"重置"]})]}),i.jsxs("div",{className:"space-x-2",children:[i.jsxs("button",{onClick:s,className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors flex items-center gap-2",children:[i.jsx(gt,{className:"w-4 h-4"}),"保存结果"]}),i.jsxs("button",{className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors flex items-center gap-2",children:[i.jsx($t,{className:"w-4 h-4"}),"导入数据"]})]})]}),i.jsxs("div",{className:"border-t pt-4",children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(Le,{className:"w-5 h-5 text-blue-600"}),"仿真结果"]}),f()]})]})},Wr=()=>i.jsxs("div",{className:"grid gap-6",children:[i.jsx(Gt,{}),i.jsx(Br,{})]});export{Wr as Simulator};
